<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Relatórios de Alunos</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; }
    input[type="text"] { padding: 8px; width: 300px; margin-bottom: 20px; }
    table { width: 100%; border-collapse: collapse; margin-top: 10px; }
    th, td { border: 1px solid #ddd; padding: 8px; text-align: center; }
    th { background-color: #f2f2f2; }
    button { margin: 0 5px; padding: 5px 10px; }
  </style>
</head>
<body>
  <h1>Relatório de Alunos</h1>

  <input type="text" id="busca" placeholder="Buscar por nome..." oninput="carregarAlunos()" />

  <table id="tabela-alunos">
    <thead>
      <tr>
        <th>Nome</th>
        <th>Email</th>
        <th>Status</th>
        <th>Ações</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <script>
    function gerarAlunosSeNecessario() {
      const alunosExistentes = JSON.parse(localStorage.getItem('alunos')) || [];
      if (alunosExistentes.length >= 70) return; // já existem alunos suficientes

      const novosAlunos = [];
      for (let i = alunosExistentes.length + 1; i <= 70; i++) {
        novosAlunos.push({
          nome: `Aluno ${i}`,
          email: `aluno${i}@academia.com`,
          status: i % 5 === 0 ? 'em risco' : 'ativo'
        });
      }

      const todos = alunosExistentes.concat(novosAlunos);
      localStorage.setItem('alunos', JSON.stringify(todos));
    }

    function carregarAlunos() {
      const alunos = JSON.parse(localStorage.getItem('alunos')) || [];
      const filtro = document.getElementById('busca').value.toLowerCase();
      const tbody = document.querySelector('#tabela-alunos tbody');
      tbody.innerHTML = '';

      alunos
        .filter(aluno => aluno.nome.toLowerCase().includes(filtro))
        .forEach((aluno, index) => {
          const tr = document.createElement('tr');
          tr.innerHTML = `
            <td>${aluno.nome}</td>
            <td>${aluno.email}</td>
            <td>${aluno.status}</td>
            <td>
              <button onclick="editarAluno(${index})">Editar</button>
              <button onclick="removerAluno(${index})">Remover</button>
            </td>
          `;
          tbody.appendChild(tr);
        });
    }

    function removerAluno(index) {
      const alunos = JSON.parse(localStorage.getItem('alunos')) || [];
      if (confirm(`Deseja realmente remover ${alunos[index].nome}?`)) {
        alunos.splice(index, 1);
        localStorage.setItem('alunos', JSON.stringify(alunos));
        carregarAlunos();
      }
    }

    function editarAluno(index) {
      const alunos = JSON.parse(localStorage.getItem('alunos')) || [];
      const aluno = alunos[index];

      const novoNome = prompt("Editar nome:", aluno.nome);
      const novoEmail = prompt("Editar email:", aluno.email);
      const novoStatus = prompt("Editar status (ativo/em risco):", aluno.status);

      if (novoNome && novoEmail && novoStatus) {
        alunos[index] = {
          nome: novoNome,
          email: novoEmail,
          status: novoStatus
        };
        localStorage.setItem('alunos', JSON.stringify(alunos));
        carregarAlunos();
      }
    }

    // Ao carregar a página:
    window.onload = () => {
      gerarAlunosSeNecessario();
      carregarAlunos();
    };
  </script>
</body>
</html>
